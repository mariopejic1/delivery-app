<%- include("../partials/header") %>

<section class="home-section card">
    <h1>Dobrodo≈°li na na≈°u stranicu</h1>
    <p>Odaberite svoju dostavnu slu≈æbu i po≈°aljite po≈°iljku.</p>
    <p>Brza i sigurna dostava svih po≈°iljaka.</p>

    <div class="tracking-box">
        <h3>üì¶ Prati svoju po≈°iljku</h3>
        <form action="/" method="GET" class="search-form">
            <input type="text" name="trackingId" placeholder="Unesite ID po≈°iljke..." required class="search-input">
            <button type="submit" class="btn btn-primary">Tra≈æi</button>
        </form>

        <% if (locals.error) { %>
            <p style="color: #dc3545; margin-top: 15px; font-weight: 600;"><%= error %></p>
        <% } %>

        <% if (locals.shipment) { %>
            <div class="tracking-result">
                <h4>Rezultat za: <small><%= shipment._id %></small></h4>
                <hr style="opacity: 0.1; margin: 1rem 0;">

                <div class="info-section">
                    <strong>Status po≈°iljke</strong>
                    <% const statusMap = { CREATED: "NA ƒåEKANJU", ASSIGNED: "UPUƒÜENO", IN_TRANSIT: "U TIJEKU", DELIVERED: "DOSTAVLJENO" } %>
                    <span class="status-text"><%= statusMap[shipment.status] %></span>
                </div>

                <div class="info-section">
                    <strong>Datum i vrijeme</strong>
                    <span><%= new Date(shipment.createdAt).toLocaleDateString('hr-HR') %> u <%= new Date(shipment.createdAt).toLocaleTimeString('hr-HR', {hour: '2-digit', minute:'2-digit'}) %></span>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="info-section">
                        <strong>Primatelj:</strong>
                        <%= shipment.receiverName %><br>
                        <%= shipment.receiverAddress %><br>
                        <small><%= shipment.receiverPhone %></small>
                    </div>

                    <div class="info-section">
                        <strong>Po≈°iljatelj:</strong>
                        <% if(shipment.sender) { %>
                            <%= shipment.sender.name %><br>
                            <small><%= shipment.sender.email %></small>
                        <% } else { %>
                            <span style="color: #999;">Podaci nedostupni</span>
                        <% } %>
                    </div>
                </div>

                <div class="info-section" style="border-top: 1px solid #eee; padding-top: 15px;">
                    <strong>Detalji dostave</strong><br>
                    Cijena: <strong><%= shipment.price %> ‚Ç¨</strong><br>
                    <% if(shipment.company) { %>
                        Slu≈æba: <%= shipment.company.name %><br>
                    <% } %>
                    <% if(shipment.courier) { %>
                        Kurir: <%= shipment.courier.name %> (Kontakt telefon: <%= shipment.courier.phone || 'Nema mob.' %>)
                    <% } %>
                </div>
            </div>
        <% } %>
    </div>

</section>

<%- include("../partials/footer") %>